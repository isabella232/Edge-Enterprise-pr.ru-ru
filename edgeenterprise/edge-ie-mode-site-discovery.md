---
title: Пошаговое руководство по Enterprise Site Discovery
ms.author: collw
author: appcompatguy
manager: saudm
ms.date: 01/19/2022
audience: ITPro
ms.topic: conceptual
ms.prod: microsoft-edge
ms.localizationpriority: medium
ms.collection: M365-modern-desktop
description: Использование средства Enterprise Site Discovery для подготовки к режиму IE
ms.openlocfilehash: a93569f455e5671a2d4adf8f5f70238d3f23143d
ms.sourcegitcommit: 556aca8dde42dd66364427f095e8e473b86651a0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/15/2022
ms.locfileid: "12445603"
---
# <a name="enterprise-site-discovery-step-by-step-guide"></a>Пошаговое руководство по Enterprise Site Discovery

>[!Note]
> Поддержка классического приложения Internet Explorer 11 будет прекращена 15 июня 2022 г. (список области применения см. в [вопросах и ответах](https://techcommunity.microsoft.com/t5/windows-it-pro-blog/internet-explorer-11-desktop-app-retirement-faq/ba-p/2366549)). Те же приложения и сайты IE11, которые вы используете сегодня, можно открывать в Microsoft Edge в режиме Internet Explorer. Дополнительные сведения см. [здесь](https://blogs.windows.com/windowsexperience/2021/05/19/the-future-of-internet-explorer-on-windows-10-is-in-microsoft-edge/).

В этой статье представлено пошаговое руководство по использованию средства Enterprise Site Discovery в Microsoft Endpoint Configuration Manager.

Enterprise Site Discovery помогает настроить список сайтов в режиме предприятия. Enterprise Site Discovery помогает:

- Обнаруживать сайты, использующие устаревшие режимы документов. Если эти сайты не обнаруживают современные браузеры и не содержат другие элементы HTML, им, скорее всего, потребуется использовать режим IE.
- Обнаруживать сайты, использующие элементы ActiveX. Microsoft Edge не поддерживает элементы ActiveX. Если эти сайты не обнаруживают современные браузеры и не содержат другие элементы HTML, им, скорее всего, потребуется использовать режим IE.

> [!NOTE]
> Эта статья относится к Microsoft Edge версии 77 или более поздней; каналы **Stable**, **Beta** и **Dev**.

## <a name="prerequisites"></a>Предварительные условия

В этом руководстве предполагается, что вы опытный пользователь Microsoft Endpoint Configuration Manager, и у вас установлены следующие службы и роли:

1. Microsoft Endpoint Configuration Manager
2. Службы отчетов Microsoft SQL Server Reporting Services
3. (Необязательно) Настроена роль точки служб отчетов Configuration Manager

## <a name="download-enterprise-site-discovery-tools"></a>Скачивание набора средств Enterprise Site Discovery

Скачайте следующие средства:

- [Пакет установки и настройки Enterprise Site Discovery](https://go.microsoft.com/fwlink/p/?LinkId=517719)
- [Построитель отчетов для Майкрософт](https://www.microsoft.com/download/details.aspx?id=53613)

## <a name="enable-enterprise-site-discovery"></a>Включение Enterprise Site Discovery

Перед подключением к инструментарию управления Windows (WMI) для получения данных об обнаружении сайтов вам потребуется сначала развернуть поставщика класса WMI на устройстве.

Из **пакета установки и настройки Enterprise Site Discovery** извлеките содержимое в папку файлового ресурса определенной библиотеки программного обеспечения. Пример: **\\\\DSL\\EnterpriseSiteDiscovery**.

Затем создайте пакет в Microsoft Endpoint Configuration Manager, как описано в [документации](/configmgr/apps/deploy-use/packages-and-programs), выбрав следующие параметры:

- На странице **Пакет** выберите **Имя** и укажите имя **Включение обнаружения сайтов**
- На странице **Пакет** установите флажок **Этот пакет содержит исходные файлы**
- На странице **Пакет** укажите исходную папку, в которую вы извлекли файлы (например, **\\\\DSL\\EnterpriseSiteDiscovery**)
- На странице **Тип программы** выберите **Стандартная программа**
- На странице **Стандартная программа** введите командную строку, чтобы настроить обнаружение сайтов на устройстве следующим образом:
  ```dos
  powershell.exe -ExecutionPolicy Bypass .\IETelemetrySetUp-Win8.ps1
  ```
  > [!NOTE]
  > Скрипт поддерживает использование параметров командной строки для `-ZoneAllowList` и `-SiteAllowList`. Для этого пошагового руководства мы настроим эти параметры с помощью групповой политики (ниже).
- На странице **Стандартная программа** выберите параметр для запуска **Скрытно**.
- На странице **Стандартная программа** в разделе **Программа может работать** выберите параметр **Независимо от входа пользователя**

После создания пакета дважды щелкните его имя **Включение обнаружения сайтов**, чтобы просмотреть его свойства. В свойстве **После запуска** выберите **Configuration Manager перезапускает компьютер**. Сбор данных WMI начнется после перезагрузки устройств.

> [!NOTE]
> Вы можете настроить интервал времени, в течение которого пользователю нужно перезапустить устройство, как описано в [документации по параметрам клиента](/configmgr/core/clients/deploy/about-client-settings#computer-restart).

## <a name="configure-enterprise-site-discovery-via-group-policy"></a>Настройка средства Enterprise Site Discovery с помощью групповой политики

Если средство Enterprise Site Discovery включено, вы можете указать, какие данные нужно собирать. Учитывайте местное законодательство и нормативные требования, как описано [здесь](/internet-explorer/ie11-deploy-guide/collect-data-using-enterprise-site-discovery#what-data-is-collected).

1. Откройте редактор групповых политик.
2. Выберите **Конфигурация компьютера** > **Административные шаблоны** > **Компоненты Windows** > **Internet Explorer**. 
3. Дважды щелкните **Включить вывод результатов обнаружения сайтов в WMI**.
4. Выберите **Включено**.
5. Нажмите **ОК** или **Применить**, чтобы сохранить этот параметр политики.

Вы можете ограничить зоны сбора данных сайтов:

1. Дважды щелкните **Ограничить результаты обнаружения сайтов по зоне**.
2. Выберите **Включено**.
3. Введите битовую маску, указывающую, для каких зон нужно включить обнаружение сайтов:
    1. Зона ограниченных сайтов
    2. Зона Интернета
    3. Зона надежных сайтов
    4. Зона местной интрасети
    5. Зона локального компьютера
    
    Пример 1: **00010** будет собирать данные только для зоны локальной интрасети.

    Пример 2: **10111** будет собирать данные для всех зон, кроме зоны Интернета.
4. Нажмите **ОК** или **Применить**, чтобы сохранить этот параметр политики.

Вы можете ограничить домены сбора данных сайтов:

1. Дважды щелкните **Ограничить результаты обнаружения сайтов по домену**.
2. Выберите **Включено**.
3. Укажите домены, для которых нужно собирать данные, по одному домену в строке.
4. Нажмите **ОК** или **Применить**, чтобы сохранить этот параметр политики.

## <a name="collect-site-discovery-data-using-configuration-manager"></a>Сбор данных обнаружения сайтов с помощью Configuration Manager

Теперь, когда ваши устройства создают данные, пора собирать эти данные в Configuration Manager.

1. В консоли Configuration Manager выберите **Администрирование** > **Параметры клиента** > **Параметры клиента по умолчанию**.
2. На вкладке **Главная** в группе **Свойства** выберите **Свойства**.
3. В диалоговом окне **Параметры клиента по умолчанию** выберите **Инвентаризация оборудования**.
4. В списке **Параметры устройства** выберите **Задать классы**.
5. В диалоговом окне **Классы инвентаризации оборудования** выберите **Добавить**.
6. В диалоговом окне **Добавление класса инвентаризации оборудования** щелкните **Подключить**.
7. В диалоговом окне **Подключение к инструментарию управления Windows (WMI)** введите имя компьютера, на котором настроено средство Enterprise Site Discovery. Если вы подключаетесь к другому компьютеру, вам потребуются учетные данные с разрешениями на доступ к WMI.
8. В поле **Пространство имен WMI** введите **root\cimv2\IETelemetry**.
9. Нажмите **Подключить**.
10. В **диалоговом окне Add Hardware Inventory Class** в списке классов инвентаризации выберите классы **WMI IESystemINfo**, **IEUrlInfo** и **IECountInfo**.****
11. Нажмите кнопку **ОК**, чтобы закрыть диалоговое окно **Квалификаторы класса** и другие открытые диалоговые окна.

После того как обновлены параметры клиента из точки управления, данные будут добавляться в отчет при следующем запуске инвентаризации оборудования (по умолчанию каждые семь дней).

## <a name="import-site-discovery-reports"></a>Импорт отчетов об обнаружении сайтов

Пакет Enterprise Site Discovery включает два примера отчетов. В одном отчете показаны сайты, использующие элементы ActiveX, а в другом — сайты, использующие устаревшие режимы документов.

### <a name="configure-the-site-discovery-sample-report"></a>Настройка примера отчета об обнаружении сайтов

Выполните следующую процедуру, чтобы создать пример отчета, использующего три источника данных: сайты, посещаемые пользователем, сведения о системе и режимы документов, используемые сайтами. Этот отчет помогает определить сайты, которые могут зависеть от устаревших режимов документов.

1. Скопируйте отчет **SCCM_Report-Site_Discovery.rdl** на свой сервер Configuration Manager.
2. Установите [Построитель отчетов для Майкрософт](/sql/reporting-services/install-windows/install-report-builder?view=sql-server-ver15).
3. Дважды щелкните **SCCM_Report-Site_Discovery.rdl**, чтобы открыть отчет в Построителе отчетов.
4. При первом открытии отчета он попытается связаться с сервером, на котором он был создан. При запросе на **подключение к серверу отчета** щелкните **Нет**.
5. После открытия отчета разверните **Источники данных** и дважды щелкните **DataSource1**.
6. В окне **Свойства источника данных** выберите **Использовать подключение, внедренное в отчет** и нажмите кнопку **Создать...**.
7. В окне **Свойства подключения** выберите **Имя сервера** и введите имя сервера Configuration Manager. Затем в разделе **Выберите или введите имя базы данных** выберите имя базы данных Configuration Manager из раскрывающегося списка.
8. Нажмите кнопку **ОК**, чтобы закрыть окно **Свойства подключения**.
9. Чтобы проверить подключение, нажмите **Протестировать подключение**. В случае успешного подключения нажмите кнопку **ОК**, чтобы закрыть окно **Свойства источника данных**.
10. Повторите шаги с 5 по 9 для **источника данных 2**.
11. Разверните **Наборы данных** и дважды щелкните **DataSet1**.
12. В окне **Свойства набора данных** выберите поле **Запрос:** и замените **USE CM_A1B** именем базы данных, выбранным на шаге 7.
13. Повторите действия 11–12 для **DataSet2**, **DataSet3** и **DataSet4**.
14. На вкладке **Главная** ленты нажмите кнопку **Выполнить**, чтобы проверить отчет.
15. Сохраните отчет.
16. Закройте Построитель отчетов для Майкрософт.
17. Измените имя файла на **Обнаружение сайтов.rdl**

### <a name="configure-the-activex-sample-report"></a>Настройка примера отчета ActiveX

Выполните следующую процедуру, чтобы создать пример отчета, использующего один источник данных: сайты, применяющие элементы ActiveX. Так как Internet Explorer является единственным браузером, поддерживающими элементы ActiveX, для этих сайтов может потребоваться режим IE.

1. Скопируйте отчет **SCCM Report Sample - ActiveX.rdl** на свой сервер Configuration Manager.
2. Установите [Построитель отчетов для Майкрософт](/sql/reporting-services/install-windows/install-report-builder?view=sql-server-ver15).
3. Дважды щелкните **SCCM Report Sample - ActiveX.rdl**, чтобы открыть отчет в Построителе отчетов.
4. При первом открытии отчета он попытается связаться с сервером, на котором он был создан. При запросе на **подключение к серверу отчета** щелкните **Нет**.
5. После открытия отчета разверните **Источники данных** и дважды щелкните **AutoGen__5C6358F2_4BB6_4a1b_A16E_8D96795D8602_**.
6. В окне **Свойства источника данных** выберите **Использовать подключение, внедренное в отчет** и нажмите кнопку **Создать...**.
7. В окне **Свойства подключения** выберите **Имя сервера** и введите имя сервера Configuration Manager. Затем в разделе **Выберите или введите имя базы данных** выберите имя базы данных Configuration Manager из раскрывающегося списка.
8. Нажмите кнопку **ОК**, чтобы закрыть окно **Свойства подключения**.
9. Чтобы проверить подключение, нажмите **Протестировать подключение**. В случае успешного подключения нажмите кнопку **ОК**, чтобы закрыть окно **Свойства источника данных**.
10. Разверните **Наборы данных** и дважды щелкните **DataSet1**.
11. В окне **Свойства набора данных** выберите поле **Запрос:** и замените **USE CM_A1B** именем базы данных, выбранным на шаге 7.
12. На вкладке **Главная** ленты нажмите кнопку **Выполнить**, чтобы проверить отчет.
13. Сохраните отчет.
14. Закройте Построитель отчетов для Майкрософт.
15. Измените имя файла на **ActiveX**.

### <a name="upload-configured-reports-to-microsoft-sql-server-reporting-services"></a>Отправка настроенных отчетов в службы отчетов Microsoft SQL Server Reporting Services

После настройки отчетов для своей среды отправьте их на сервер отчетов.

1. Запустите приложение **Диспетчер конфигурации Reporting Services**.
2. В окне **Подключение к серверу отчетов** щелкните **Подключение** и выберите URL-адрес, указанный в разделе **Идентификация сайтов веб-портала**.
3. В открывшемся окне браузера (вы должны оказаться на **странице SQL Server Reporting Services**) щелкните папку **ConfigMgr_SCCMSiteCode** для кода вашего сайта SCCM.
4. На ленте наведите курсор на элемент **+ Создать** и выберите пункт меню **Папка**.
5. Введите имя папки, например **Enterprise Site Discovery**, и нажмите кнопку **Создать**.
6. Щелкните папку **Enterprise Site Discovery**.
7. На ленте нажмите кнопку **Отправить**.
8. Выберите отчет **Обнаружение сайтов** и нажмите кнопку **ОК**.
9. Повторите шаги 7 и 8 для отчета **ActiveX**.

### <a name="view-reports-in-configuration-manager"></a>Просмотр отчетов в Configuration Manager

После настройки и отправки отчетов вы можете просмотреть их в Configuration Manager.

1. В консоли Configuration Manager выберите **Мониторинг** > **Создание отчетов** > **Отчеты** > **Enterprise Site Discovery**.
2. Дважды щелкните отчет, чтобы просмотреть его.

## <a name="disable-enterprise-site-discovery"></a>Отключение Enterprise Site Discovery

После завершения сбора данных нужно отключить Enterprise Site Discovery. Создайте второй пакет, чтобы отключить Enterprise Site Discovery в Microsoft Endpoint Configuration Manager, как описано в [документации](/configmgr/apps/deploy-use/packages-and-programs), выбрав следующие параметры:

- На странице **Пакет** выберите **Имя** и укажите имя **Отключение обнаружения сайтов**
- На странице **Пакет** установите флажок **Этот пакет содержит исходные файлы**
- На странице **Пакет** укажите исходную папку, в которую вы извлекли файлы (например, **\\\\DSL\\EnterpriseSiteDiscovery**)
- На странице **Тип программы** выберите **Стандартная программа**
- На странице **Стандартная программа** введите командную строку, отключающую обнаружение сайтов на устройстве, следующим образом:
  ```dos
  powershell.exe -ExecutionPolicy Bypass .\IETelemetrySetUp-Win8.ps1 -IEFeatureOff
  ```
- На странице **Стандартная программа** выберите параметр для запуска **Скрытно**
- На странице **Стандартная программа** в разделе **Программа может работать** выберите параметр **Независимо от входа пользователя**

## <a name="see-also"></a>См. также

- [Целевая страница Microsoft Edge Enterprise](https://aka.ms/EdgeEnterprise)
- [Сведения о режиме IE](./edge-ie-mode.md)
- [Дополнительные сведения о режиме предприятия](/internet-explorer/ie11-deploy-guide/enterprise-mode-overview-for-ie11)
- [Дополнительные сведения об Enterprise Site Discovery](/internet-explorer/ie11-deploy-guide/collect-data-using-enterprise-site-discovery)